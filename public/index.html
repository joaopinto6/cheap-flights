<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cheap Flights</title>
    <link rel="stylesheet" href="style.css">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
</head>
<body>
    <h1>Top Voos mais Baratos</h1>
    <p id="checkflights">loading...</p>
    <div id="info" class="flashcard-container">
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
        <div class="flashcard">
            <img alt="error">
            <h2 class="country"></h2>
            <p class="date"></p>
            <p class="price"></p>
        </div>
    </div>
</body>
<script>
    const checkflights = document.getElementById('checkflights')
    const info = document.getElementById('info')
    const image = document.getElementsByTagName('img')
    const country = document.getElementsByClassName('country')
    const date = document.getElementsByClassName('date')
    const price = document.getElementsByClassName('price')

    window.addEventListener("load", async () => {
        const response = await fetch('/.netlify/functions/db')
            .then(response => response.json())

        const flights_array = response.flights.slice(0, 10)

        for (let i = 0; i < image.length; i++) {
            image[i].src = "assets/" + flights_array[i][0] + ".jpg"
            image[i].alt = flights_array[i][0]
            country[i].innerText = flights_array[i][0]
            date[i].innerText = flights_array[i][1]
            price[i].innerText = flights_array[i][2] + 'â‚¬'
        }

        checkflights.innerHTML = ''
        info.style.visibility = 'visible'
    });
</script>
</html>