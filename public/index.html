<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cheap Flights</title>
    <link rel="stylesheet" href="style.css">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
</head>
<body>
    <h1>Top 3 Voos mais Baratos</h1>
    <p id="checkflights">loading...</p>
    <div id="info" class="flashcard-container">
        <div class="flashcard">
            <img src="image1.jpg" alt="Image 1">
            <h2 class="country">Title 1</h2>
            <p class="date">Subtitle 1</p>
            <p class="price">Subtitle 1</p>
        </div>
        <div class="flashcard">
            <img src="image2.jpg" alt="Image 2">
            <h2 class="country">Title 2</h2>
            <p class="date">Subtitle 2</p>
            <p class="price">Subtitle 2</p>
        </div>
        <div class="flashcard">
            <img src="image3.jpg" alt="Image 3">
            <h2 class="country">Title 3</h2>
            <p class="date">Subtitle 3</p>
            <p class="price">Subtitle 3</p>
    </div>
    <div id="footer">
        <a id="pexels" href="https://www.pexels.com">Photos provided by Pexels</a>
    </div>
</body>
<script type="text/javascript">
    const checkflights = document.getElementById('checkflights')
    const info = document.getElementById('info')
    const image = document.getElementsByTagName('img')
    const pexels = document.getElementById('pexels')
    const country = document.getElementsByClassName('country')
    const date = document.getElementsByClassName('date')
    const price = document.getElementsByClassName('price')

    window.addEventListener("load", async () => {
        const response = await fetch('/.netlify/functions/meta')
            .then(response => response.json())

        const flights_array = response.flights_array.slice(0, 3)

        for (let i = 0; i < image.length; i++) {
            image[i].src = "/assets/"+flights_array[i][0]+".jpg"
            country[i].innerText = flights_array[i][0]
            date[i].innerText = flights_array[i][1]
            price[i].innerText = flights_array[i][2] + 'â‚¬'
        }

        checkflights.innerHTML = ''
        info.style.visibility = 'visible'
        pexels.style.visibility = 'visible'
    });

    

</script>    
</html>